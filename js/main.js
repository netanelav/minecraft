let minecraft = {
  blocks: {
    sky: { type: "sky", tool: "none" },
    cloud: { type: "cloud", tool: "cloudTool" },
    dirt: { type: "dirt", tool: "shovel" },
    grass: { type: "grass", tool: "shovel" },
    leaf: { type: "leaf", tool: "axe" },
    tree: { type: "tree", tool: "axe" },
    rock: { type: "rock", tool: "pickaxe" }
  },

  matrix: [
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "rock",
      "rock",
      "rock",
      "rock",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "rock",
      "rock"
    ],
    [
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ]
  ]
};

minecraft.createBoard = function() {
  var gameBoard = $("#gameBoard");

  for (var i = 0; i < minecraft.matrix.length; i++) {
    var newRow = document.createElement("div");
    newRow.classList.add("blocks-row");
    newRow.setAttribute("width", "100%");
    gameBoard.append(newRow);

    for (var j = 0; j < minecraft.matrix[i].length; j++) {
      var newBlock = document.createElement("span");
      newBlock.classList.add("block");
      newBlock.setAttribute("block-type",minecraft.blocks[minecraft.matrix[i][j]].type);
      newBlock.setAttribute("tool",minecraft.blocks[minecraft.matrix[i][j]].tool);
      newRow.append(newBlock);
    }
  }
};

minecraft.startGame = function(){
    $('#landing-page').css('display', 'none');
    $('.container').css('display', 'block');
    minecraft.createBoard();
};

$("#start").click(minecraft.startGame);

let stackSize = 0;
let blockToPosition;
var currentTool = "pickaxe";
$("#pickaxe").addClass("blueBorder");

minecraft.chooseTool = function(e) {
  $(`#${currentTool}`).removeClass("blueBorder");
  if (e.currentTarget.id === "stack" && e.target.id === "stack") {
    currentTool = "noTool";
  } else {
    currentTool = e.currentTarget.id;
    e.target.classList += " blueBorder";
    if (currentTool === "stack") blockToPosition = e.target;
  }
};

$(".tool").click(minecraft.chooseTool);
$("#stack").click(minecraft.chooseTool);

minecraft.chooseInWorldBlock = function(e) {
  function updateBlockStack(type) {
    //   document.getElementById("stack").setAttribute("block-type", type);
    if ($("#stack").children().length < 6) {
      $("#stack").append(`<span class="stackItem m-0 p-0" block-type="${type}"></span>`);
      stackSize++;
    } else {
      //needs to remove first element entered FOFO
      // $("#stack").append(`<span class="stackItem m-0 p-0" block-type="${type}"></span>`);
      // $("#stack").append(`<span class="stackItem m-0 p-0" block-type="${type}"></span>`);
    }
  }

  let type = e.target.getAttribute("block-type");

  if (currentTool === "stack") {
    console.log("tool=stack");
    if (document.getElementById("stack").getAttribute("block-type") !== "sky") {
      let stackType = document
        .getElementById("stack")
        .getAttribute("block-type");
      if (stackType !== "sky") {
        e.target.setAttribute("block-type", stackType);
        document.getElementById("stack").setAttribute("block-type", "sky");
        $("#stack").removeClass("blueBorder");
      } //stack: just the block should flash red
    }
  } else if (minecraft.blocks[type].tool === currentTool) {
    console.log("correct tool");
    e.target.setAttribute("block-type", "sky");
    updateBlockStack(type);
    {
    }
  } else {
    minecraft.toolFlashRed(currentTool);
    console.log("incorrect tool");
  }
};
$(".block").click(minecraft.chooseInWorldBlock);

minecraft.toolFlashRed = function(currentTool) {
  $(`#${currentTool}`).removeClass("blueBorder");
  $(`#${currentTool}`).addClass("redBorder");
  setTimeout(() => {
    $(`#${currentTool}`).addClass("blueBorder");
    $(`#${currentTool}`).removeClass("redBorder");
  }, 400);
};
