let minecraft = {
  blocks: {
    sky: { type: "sky", tool: "none" },
    cloud: { type: "cloud", tool: "cloudTool" },
    dirt: { type: "dirt", tool: "shovel" },
    grass: { type: "grass", tool: "shovel" },
    leaf: { type: "leaf", tool: "axe" },
    tree: { type: "tree", tool: "axe" },
    rock: { type: "rock", tool: "pickaxe" }
  },

  tools: {},

  matrix: [
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "cloud",
      "cloud",
      "cloud",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky"
    ],
    [
      "sky",
      "sky",
      "sky",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "leaf",
      "sky",
      "sky",
      "sky",
      "sky",
      "sky",
      "rock",
      "rock",
      "rock",
      "rock",
      "sky",
      "sky",
      "sky",
      "sky",
      "tree",
      "tree",
      "sky",
      "sky",
      "sky",
      "rock",
      "rock"
    ],
    [
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass",
      "grass"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ],
    [
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt",
      "dirt"
    ]
  ]
};

minecraft.createBoard = function() {
  var gameBoard = $("#gameBoard");
  for (var i = 0; i < minecraft.matrix.length; i++) {
    var newRow = document.createElement("div");
    newRow.classList.add("blocks-row");
    newRow.setAttribute("width", "100%");
    gameBoard.append(newRow);
    for (var j = 0; j < minecraft.matrix[i].length; j++) {
      var newBlock = document.createElement("span");
      newBlock.classList.add("block");
      newBlock.setAttribute(
        "block-type",
        minecraft.blocks[minecraft.matrix[i][j]].type
      );
      newBlock.setAttribute(
        "tool",
        minecraft.blocks[minecraft.matrix[i][j]].tool
      );
      newRow.append(newBlock);
    }
  }
};

minecraft.createBoard();
let stackSize = 0;
let blockToPosition;
var currentTool = "pickaxe";
$("#pickaxe").addClass("blue");

function chooseTool(eventObject) {
  $(`#${currentTool}`).removeClass("blue");
  if (
    eventObject.currentTarget.id === "stack" &&
    eventObject.target.id === "stack"
  ) {
    currentTool = "noTool";
  } else {
    currentTool = eventObject.currentTarget.id;
    eventObject.target.classList += " blue";
    if (currentTool === "stack") blockToPosition = eventObject.target;
  }
}
$(".tool").click(chooseTool);
$("#stack").click(chooseTool);

function updateBlockStack(type) {
  //   document.getElementById("stack").setAttribute("block-type", type);
  if (stackSize < 6) {
    $("#stack").append(
      `<span class="stackItem m-0 p-0" block-type="${type}"></span>`
    );
    stackSize++;
  } else {
    //needs to remove first element entered FOFO
    // $("#stack").append(`<span class="stackItem m-0 p-0" block-type="${type}"></span>`);
    // $("#stack").append(`<span class="stackItem m-0 p-0" block-type="${type}"></span>`);
  }
}

function chooseBlock(eventObject) {
  let type = eventObject.target.getAttribute("block-type");
  console.log(eventObject.target.getAttribute("block-type"));

  if (currentTool === "stack") {
    console.log("tool=stack");
    if (document.getElementById("stack").getAttribute("block-type") !== "sky") {
      let stackType = document
        .getElementById("stack")
        .getAttribute("block-type");
      if (stackType !== "sky") {
        eventObject.target.setAttribute("block-type", stackType);
        document.getElementById("stack").setAttribute("block-type", "sky");
        $("#stack").removeClass("blue");
      } //stack: just the block should flash red
    }
  } else if (minecraft.blocks[type].tool === currentTool) {
    console.log("correct tool");
    eventObject.target.setAttribute("block-type", "sky");
    updateBlockStack(type);
    {
    }
  } else {
    flashRed(currentTool);
    console.log("incorrect tool");
  }
}

$(".block").click(chooseBlock);
document.getElementById("stack").setAttribute("block-type", "sky");

function flashRed(currentTool) {
  $(`#${currentTool}`).removeClass("blue");
  $(`#${currentTool}`).addClass("red");
  setTimeout(() => {
    $(`#${currentTool}`).addClass("blue");
    $(`#${currentTool}`).removeClass("red");
  }, 400);
}
